
#####-----基础配置-----#####
# 敌方颜色：red | blue
enemy_color: "blue"

#####-----神经网络参数-----#####
# 选择装甲板识别后端：yolov8 | yolo11 | yolov5
yolo_name: yolov8

# 数字/字迹分类器模型路径
classify_model: assets/tiny_resnet.onnx

# YOLO模型路径（根据yolo_name选择对应模型）
yolo11_model_path: assets/yolo11.xml      # 输入640×640
yolov8_model_path: assets/yolov8.xml        # 输入416×416
yolov5_model_path: assets/yolov5.xml        # 输入640×640

# OpenVINO推理设备：CPU | GPU | AUTO
# CPU: 使用CPU推理（兼容性最好）
# GPU: 使用GPU推理（需要Intel核显驱动）
# AUTO: 自动选择最优设备
device: CPU

# 分类器最小置信度（0.0-1.0）
min_confidence: 0.8

# 是否启用传统角点微调（仅yolov5使用）
use_traditional: true

#####-----功能开关-----#####
# 是否启用打符模块
enable_buff: false

#####-----ROI（感兴趣区域）参数-----#####
roi:
  x: 420          # ROI左上角X坐标
  y: 50           # ROI左上角Y坐标
  width: 600      # ROI宽度
  height: 600     # ROI高度

# 是否启用ROI裁剪（首次联调建议false）
use_roi: false

#####-----传统检测方法参数-----#####
# 注意：仅在use_traditional=true时使用
threshold: 150                         # 二值化阈值（0-255）
max_angle_error: 45                    # 灯条最大倾角误差（度）
min_lightbar_ratio: 1.5                # 灯条高宽比下限
max_lightbar_ratio: 20                 # 灯条高宽比上限
min_lightbar_length: 8                 # 灯条最小长度（像素）
min_armor_ratio: 1                     # 装甲板宽高比下限
max_armor_ratio: 5                     # 装甲板宽高比上限
max_side_ratio: 1.5                    # 两侧灯条长度比上限
max_rectangular_error: 25              # 矩形偏差上限（度）

#####-----Tracker（跟踪器）参数-----#####
# 连续检测到目标的最小帧数，达到后进入tracking状态
min_detect_count: 5

# 临时丢失目标的最大容忍帧数
max_temp_lost_count: 15

# 前哨站的临时丢失容忍帧数（通常设置更大）
outpost_max_temp_lost_count: 75

#####-----Aimer（瞄准器）参数-----#####
# 瞄准角度偏置（用于快速校准）
yaw_offset: -1        # 偏航角偏置（度）
pitch_offset: -1.4    # 俯仰角偏置（度）

# 小陀螺目标瞄准参数
comming_angle: 60     # 装甲板出现角度（度）
leaving_angle: 20     # 装甲板离开角度（度）

# 高低速判断阈值（rad/s）
decision_speed: 8

# 延迟补偿时间
high_speed_delay_time: 0.030    # 高速延迟（秒）
low_speed_delay_time: 0.015     # 低速延迟（秒）

# 执行延迟补偿（毫秒）
# 用于补偿命令从发送到实际执行的延迟
actuation_delay_ms: 0

# 斜坡补偿时间常数（秒）
# 用于补偿匀速目标的稳态偏差：yaw_cmd = yaw + ramp_t0 × yaw_vel
# 建议范围：0.05~0.20，设为0表示关闭
yaw_ramp_t0: 0.10               # 通用斜坡补偿

# 方向专用斜坡补偿（可选）
yaw_ramp_t0_pos: 0.10           # 向右运动时的补偿
yaw_ramp_t0_neg: 0.10           # 向左运动时的补偿

#####-----Shooter（开火控制）参数-----#####
# 射击容差（度）
first_tolerance: 3      # 近距离射击容差
second_tolerance: 2     # 远距离射击容差

# 距离判断阈值（米）
judge_distance: 2

# 是否由自瞄控制射击
auto_fire: false

#####-----相机配置-----#####
camera_name: "daheng"

# 相机基础参数
exposure_ms: 2.1        # 曝光时间（毫秒）
gain: 24                # 增益

# 相机VID:PID（用于识别特定相机）
vid_pid: "2ba2:4d55"    # 大恒相机的VID:PID

# 是否启用调试模式
debug: true

# 相机详细设置
camera_settings:
  width: 1920                    # 图像宽度
  height: 1200                   # 图像高度
  exposure: 2000                 # 曝光时间（微秒）
  auto_exposure: false           # 是否自动曝光
  gain: 24                       # 增益值
  fps: 168                       # 目标帧率
  auto_white_balance: true       # 是否自动白平衡
  rgain: 0.0                     # R通道增益（手动白平衡时使用）
  bgain: 0.0                     # B通道增益
  ggain: 0.0                     # G通道增益
  time_offset: 45500000          # 时间戳偏移
  auto_exp_change: false         # 是否允许自动曝光变化
  max_exp: 3000                  # 最大曝光时间
  min_exp: 200                   # 最小曝光时间
  pixel_format: BayerRG8         # 像素格式


#####-----相机标定参数-----#####
# 云台到IMU Body的旋转矩阵（3×3，行优先）
R_gimbal2imubody: [1, 0,0,0, 1, 0, 0 , 0, 1]

# 相机内参矩阵（3×3，行优先）
# [fx, 0, cx, 0, fy, cy, 0, 0, 1]
camera_matrix: [2807.679657, 0.000000, 954.251797, 0.000000, 2804.280283, 601.906719, 0.000000, 0.000000, 1.000000]

# 相机畸变系数（5个参数）
# [k1, k2, p1, p2, k3]
distort_coeffs: [-0.250596, -0.395102, -0.001980, 0.001022, 0.000000]

# 相机到云台的旋转矩阵（3×3，行优先，需手眼标定）
R_camera2gimbal: [-0.027182119030230909, -0.12616154330853446, 0.99163723074269183, -0.99949106557517331, 0.019998323121329122, -0.024853106601381177, -0.016695575474690555, -0.99180811252093692, -0.12664093215554434]

# 相机到云台的平移向量（3个参数，需手眼标定）
t_camera2gimbal: [0.13160669975045827, 0.10377721766577375, 0.024908271912914642]

#####-----CAN协议配置-----#####
new_can_quat_id: 0x150        # 四元数姿态帧ID
new_can_cmd_id: 0x170         # 自瞄指令帧ID
can_interface: "can0"
debug_rx: false
debug_tx: false

#####-----轨迹规划器（Planner）参数-----#####
# 开火阈值（rad）
fire_thresh: 0.0035
